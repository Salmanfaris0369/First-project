<% include('../layouts/header.ejs')%>



<link
rel="icon"
href="/static/adminfile/assets/img/kaiadmin/favicon.ico"
type="image/x-icon"
/>

<!-- Fonts and icons -->
<script src="/static/adminfile/assets/js/plugin/webfont/webfont.min.js"></script>
<script>
WebFont.load({
  google: { families: ["Public Sans:300,400,500,600,700"] },
  custom: {
    families: [
      "Font Awesome 5 Solid",
      "Font Awesome 5 Regular",
      "Font Awesome 5 Brands",
      "simple-line-icons",
    ],
    urls: ["/static/adminfile/assets/css/fonts.min.css"],
  },
  active: function () {
    sessionStorage.fonts = true;
  },
});
</script>

<!-- CSS Files -->
<link rel="stylesheet" href="/static/adminfile/assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="/static/adminfile/assets/css/plugins.min.css" />
<link rel="stylesheet" href="/static/adminfile/assets/css/kaiadmin.min.css" />

<!-- CSS Just for demo purpose, don't include it in your project -->
<link rel="stylesheet" href="/static/adminfile/assets/css/demo.css" />
</head>
<body>
<div class="wrapper">
<!-- Sidebar -->
<div class="sidebar" data-background-color="dark">
  <div class="sidebar-logo">
    <!-- Logo Header -->
    <div class="logo-header" data-background-color="white">
           
      <img
        src="/static/img/logo.png"
        alt="navbar brand"
        class="navbar-brand"
        height="20"
      />
    
  </div>
    <!-- End Logo Header -->
  </div>
  <div class="sidebar-wrapper scrollbar scrollbar-inner">
    <div class="sidebar-content">
      <ul class="nav nav-secondary">
        <li class="nav-item">
          <a
            data-bs-toggle="collapse"
            href="#dashboard"
            class="collapsed"
            aria-expanded="false"
          >
            <i class="fas fa-homee"></i>
            <p>Dashboard</p>
           </a>
        </li>
       <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/categories">
            <i class="fas fa-pen-squaree"></i>
            <p>Categories</p>
          </a>
        </li>
       <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/users">
            <i class="fas fa-pen-squaree"></i>
            <p>Users</p>
          </a>
        </li>
        <li class="nav-item">
          <a  href="/admin/product">
            <i class="fas fa-pen-squaree"></i>
            <p>products</p>
           </a>
         </li>
        <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/brand">
            <i class="fas fa-tablee"></i>
            <p>Brands</p>
           </a>
         </li>
        <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/order">
            <i class="fas fa-map-marker-altt"></i>
            <p>Orders</p>
         </a>
         </li>
        <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/coupon">
            <i class="far fa-chart-barr"></i>
            <p>Coupons</p>
          </a>
         </li>
        <li class="nav-item">
          <a href="/admin/offer">
            <i class="fas fa-desktopp"></i>
            <p>Offers</p>
           </a>
        </li>
        <li class="nav-item">
          <a data-bs-toggle="collapse" href="/admin/logout">
            <i class="fas fa-barss"></i>
            <p>Log out</p>
           </a>
        </li>
      </ul>
    </div>
  </div>
</div>
<!-- End Sidebar -->

<div class="main-panel">
  <div class="main-header">
    <div class="main-header-logo">
    
      <!-- Logo Header -->
      <div class="logo-header" data-background-color="dark">
      
        <div class="nav-toggle">
          <button class="btn btn-toggle toggle-sidebar">
            <i class="gg-menu-right"></i>
          </button>
          <button class="btn btn-toggle sidenav-toggler">
            <i class="gg-menu-left"></i>
          </button>
        </div>
        <button class="topbar-toggler more">
          <i class="gg-more-vertical-alt"></i>
        </button>
      </div>
      <!-- End Logo Header -->
    </div>
    <!-- Navbar Header -->
   
    <!-- End Navbar -->
  </div>

  <div class="container">
    <div class="page-inner">
      
      <div class="page-header" style="background-color: white;border: darkslateblue;">
       <form action="/admin/dashboard/salesReport" method="GET">
        <ul class="breadcrumbs mb-3">
          <li class="nav-home">
            <label for="startDate">Start date</label><br>
             <input type="date" id="startDate" name="startDate" value="<%= startDate.toISOString().split('T')[0] %>">
          
          </li>
        
          <li class="nav-item">
            <label for="endDate">End date</label><br>
             <input type="date" id="endDate" name="endDate" value="<%= endDate.toISOString().split('T')[0] %>">
          </li>
          <li class="nav-item">
            <label for="period">Period</label><br>
            <select id="period" name="period">
                <option value="daily" <%= period === 'daily' ? 'selected' : '' %>>Daily</option>
                <option value="monthly" <%= period === 'monthly' ? 'selected' : '' %>>Monthly</option>
                <option value="yearly" <%= period === 'yearly' ? 'selected' : '' %>>Yearly</option>
            </select>
          </li>
          <li class="nav-item">
            <button type="submit" style="border-radius: 10px;width: 80px;">filter</button>
          </li>
          
        </ul>
    </form>
    <div class="ms-5">
    <a class="btn btn-secondary" href="/admin/download?format=excel&startDate=<%= startDate.toISOString() %>&endDate=<%= endDate.toISOString() %>">Download Excel</a>
    <a class="btn btn-primary"  href="/admin/download?format=pdf&startDate=<%= startDate.toISOString() %>&endDate=<%= endDate.toISOString() %>">Download PDF</a>
    </div>
   </div>
   
     
      <div class="data" style="background-color: white;border: darkslateblue;">
                <h3 style="text-decoration: underline;">Overall sales summary</h3>
                <div class="ms-2">
                <p><strong>overall sales : ₹<%= summary.totalSales.toFixed(2) %></strong></p>
                <p><strong>overall Discounts : ₹<%= summary.totalDiscount.toFixed(2) %></strong></p>
                <p><strong>overall coupon deduction : ₹<%= summary.totalCouponDeduction.toFixed(2) %></strong></p>
                <p><strong>overall orders :</strong> <%= summary.totalOrders %></p>
                <p><strong>overall quantity :</strong><%= summary.totalQuantity %></p>
            </div>
      </div>




     

      <div class="row">
             <!-- <div class="col-md-12">
          <div class="card"> 
            
            </div> 
           </div>
        </div>  -->

        <div class="col-md-12">
          <div class="card">
            <div class="card-header">
              <h4 class="card-title">report</h4>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table
                  id="multi-filter-select"
                  class="display table table-striped table-hover"
                >
            
                  <thead>
                    <tr>
                      
                      <th>Year</th>
                      <th>Month</th>
                      <th>Product</th>
                      <th>Total quantity</th>
                      <th>Total sales</th>
                      <th>Total discount</th>
                    
                     
                     
                    </tr>
                  </thead>
                   
                  <tbody>
                    <% if (productData.length > 0) { %>
                        <% productData.forEach(function(product) { %>
                            <tr>
                                <td><%= product.year %></td>
                                <td><%= product.month %></td>
                                <td><%= product.productName %></td>
                                <td><%= product.totalQuantity %></td>
                                <td>₹<%= product.totalSales.toFixed(2) %></td>
                                <td>₹<%= product.totalDiscount.toFixed(2) %></td>
                              
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="7">No orders found</td>
                        </tr>
                    <% } %>
                    
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
       <!-- pagination -->
 <div class="pagination">
  <% if (hasPrevPage) { %>
      <a href="/admin/dashboard/salesReport?page=<%= currentPage - 1 %>"><<</a>
  <% } else { %>
      <span class="disabled"><<</span>
  <% } %>
  
  <span class="page-info border-0">
      <span class="page-number"><%= currentPage %></span> 
      <span class="page-number"><%= totalPages %></span>
  </span>
  
  <% if (hasNextPage) { %>
      <a href="/admin/dashboard/salesReport?page=<%= currentPage + 1 %>">>></a>
  <% } else { %>
      <span class="disabled">>></span>
  <% } %>
</div>
        
      </div>
    </div>
  </div>

  
</div>
 

<style>
  /* pagination  */
.pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            font-family: Arial, sans-serif;
        }
        .pagination a, .pagination span {
            color: #333;
            padding: 8px 16px;
            text-decoration: none;
            transition: background-color 0.3s;
            border: 1px solid #ddd;
            margin: 0 4px;
        }
        .pagination a:hover {
            background-color: #ddd;
        }
        .pagination .active {
            background-color: #4CAF50;
            color: white;
            border: 1px solid #4CAF50;
        }
        .pagination .page-info {
            margin: 0 15px;
        }
        .page-number {
            font-weight: bold;
            background-color: #f1f1f1;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            margin: 0 5px;
        }

/* pagination  */
</style>


<!-- End Custom template -->
</div>
<!--   Core JS Files   -->
<script src="/static/adminfile/assets/js/core/jquery-3.7.1.min.js"></script>
<script src="/static/adminfile/assets/js/core/popper.min.js"></script>
<script src="/static/adminfile/assets/js/core/bootstrap.min.js"></script>

<!-- jQuery Scrollbar -->
<script src="/static/adminfile/assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
<!-- Datatables -->
<script src="/static/adminfile/assets/js/plugin/datatables/datatables.min.js"></script>
<!-- Kaiadmin JS -->
<script src="/static/adminfile/assets/js/kaiadmin.min.js"></script>
<!-- Kaiadmin DEMO methods, don't include it in your project! -->
<script src="/static/adminfile/assets/js/setting-demo2.js"></script>
<script>
$(document).ready(function () {
  $("#basic-datatables").DataTable({});

  $("#multi-filter-select").DataTable({
    pageLength: 5,
    initComplete: function () {
      this.api()
        .columns()
        .every(function () {
          var column = this;
          var select = $(
            '<select class="form-select"><option value=""></option></select>'
          )
            .appendTo($(column.footer()).empty())
            .on("change", function () {
              var val = $.fn.dataTable.util.escapeRegex($(this).val());

              column
                .search(val ? "^" + val + "$" : "", true, false)
                .draw();
            });

          column
            .data()
            .unique()
            .sort()
            .each(function (d, j) {
              select.append(
                '<option value="' + d + '">' + d + "</option>"
              );
            });
        });
    },
  });

  // Add Row
  $("#add-row").DataTable({
    pageLength: 5,
  });

  var action =
    '<td> <div class="form-button-action"> <button type="button" data-bs-toggle="tooltip" title="" class="btn btn-link btn-primary btn-lg" data-original-title="Edit Task"> <i class="fa fa-edit"></i> </button> <button type="button" data-bs-toggle="tooltip" title="" class="btn btn-link btn-danger" data-original-title="Remove"> <i class="fa fa-times"></i> </button> </div> </td>';

  $("#addRowButton").click(function () {
    $("#add-row")
      .dataTable()
      .fnAddData([
        $("#addName").val(),
        $("#addPosition").val(),
        $("#addOffice").val(),
        action,
      ]);
    $("#addRowModal").modal("hide");
  });
});
</script>



  
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


<% include('../layouts/footer.ejs')%>